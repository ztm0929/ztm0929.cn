---
title: é›†æˆ Fuma Comment çš„ç¬”è®°
---

# ğŸ“š Fuma Comment é›†æˆåˆ°æ–‡æ¡£ç«™ç‚¹æŒ‡å—

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶æ¸…å•

åŸºäº `/apps/example-better-auth` ç¤ºä¾‹ï¼Œä½ éœ€è¦å¤åˆ¶æˆ–å‚è€ƒä»¥ä¸‹å…³é”®æ–‡ä»¶ï¼š

### ğŸ“¦ 1. ä¾èµ–åŒ… (package.json)
```json
{
  "dependencies": {
    "@fuma-comment/react": "^1.3.0",
    "@fuma-comment/server": "^1.3.0", 
    "better-auth": "^1.2.10",
    "drizzle-orm": "^0.44.2",
    "pg": "^8.16.2"
  },
  "devDependencies": {
    "drizzle-kit": "^0.31.1"
  }
}
```

### ğŸ”§ 2. æ•°æ®åº“é…ç½®æ–‡ä»¶
- `lib/database.ts` - æ•°æ®åº“è¿æ¥
- `lib/schema.ts` - æ•°æ®åº“è¡¨ç»“æ„
- `drizzle.config.ts` - Drizzle é…ç½®

### ğŸ” 3. è®¤è¯é…ç½®
- `lib/auth.ts` - Better Auth é…ç½®

### ğŸŒ 4. API è·¯ç”±
- `app/api/comments/[[...comment]]/route.ts` - è¯„è®º API
- `app/api/auth/[...all]/route.ts` - è®¤è¯ API (Better Auth)

### ğŸ¨ 5. å‰ç«¯ç»„ä»¶
- `app/page.client.tsx` - å®¢æˆ·ç«¯è¯„è®ºç»„ä»¶ç¤ºä¾‹

### âš™ï¸ 6. ç¯å¢ƒå˜é‡
- `.env.local` - æ•°æ®åº“å’Œè®¤è¯é…ç½®

---

## ğŸš€ é›†æˆæ­¥éª¤

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–
```bash
npm install @fuma-comment/react @fuma-comment/server better-auth drizzle-orm pg
npm install -D drizzle-kit @types/pg
```

### æ­¥éª¤ 2: å¤åˆ¶é…ç½®æ–‡ä»¶
ä» `example-better-auth` å¤åˆ¶è¿™äº›æ–‡ä»¶åˆ°ä½ çš„é¡¹ç›®ï¼š

1. **æ•°æ®åº“é…ç½®** â†’ `lib/`
   - `database.ts`
   - `schema.ts` 
   - `auth.ts`

2. **API è·¯ç”±** â†’ `app/api/`
   - `comments/[[...comment]]/route.ts`
   - `auth/[...all]/route.ts`

3. **é…ç½®æ–‡ä»¶** â†’ é¡¹ç›®æ ¹ç›®å½•
   - `drizzle.config.ts`

### æ­¥éª¤ 3: ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env.local`:
```env
DATABASE_URL="your_neon_database_url"
GITHUB_ID="your_github_client_id"
GITHUB_SECRET="your_github_client_secret"
BETTER_AUTH_SECRET="your_secret_key"
BETTER_AUTH_URL="https://your-domain.com"
```

### æ­¥éª¤ 4: æ•°æ®åº“è¿ç§»
```bash
npx drizzle-kit push
```

### æ­¥éª¤ 5: åœ¨æ–‡æ¡£é¡µé¢ä¸­ä½¿ç”¨
```tsx
"use client";
import { Comments } from "@fuma-comment/react";
import { createAuthClient } from "better-auth/client";

const authClient = createAuthClient();

export function DocumentComments({ pageId }: { pageId: string }) {
  const signIn = () => {
    void authClient.signIn.social({
      provider: "github",
    });
  };

  return (
    <Comments
      page={pageId}
      className="max-w-4xl mx-auto mt-8"
      auth={{
        type: "api",
        signIn,
      }}
    />
  );
}
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„ç¤ºä¾‹

```
your-docs-site/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ auth/[...all]/route.ts
â”‚   â”‚   â””â”€â”€ comments/[[...comment]]/route.ts
â”‚   â”œâ”€â”€ docs/
â”‚   â”‚   â””â”€â”€ [slug]/page.tsx  # æ–‡æ¡£é¡µé¢
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ database.ts
â”‚   â””â”€â”€ schema.ts
â”œâ”€â”€ components/
â”‚   â””â”€â”€ DocumentComments.tsx
â”œâ”€â”€ .env.local
â”œâ”€â”€ drizzle.config.ts
â””â”€â”€ package.json
```

---

## ğŸ¨ æ ·å¼é›†æˆ

### Tailwind CSS é›†æˆ
å¦‚æœä½ ä½¿ç”¨ Tailwind CSSï¼Œéœ€è¦å¯¼å…¥ Fuma Comment çš„æ ·å¼ï¼š

```css
/* globals.css */
@import "@fuma-comment/react/style.css";
```

### è‡ªå®šä¹‰ä¸»é¢˜
```tsx
<Comments
  page={pageId}
  className="max-w-4xl mx-auto mt-8"
  auth={{ type: "api", signIn }}
  // è‡ªå®šä¹‰æ ·å¼
  style={{
    "--fc-primary": "#your-brand-color",
    "--fc-background": "#your-background-color",
  }}
/>
```

---

## ğŸ”„ ä¸åŒæ–‡æ¡£æ¡†æ¶é›†æˆ

### Next.js (App Router)
- å®Œå…¨å…¼å®¹ï¼Œå‚è€ƒ `example-better-auth`

### Docusaurus
```tsx
// åœ¨ MDX æ–‡ä»¶ä¸­
import { Comments } from "@fuma-comment/react";

# æˆ‘çš„æ–‡æ¡£é¡µé¢

å†…å®¹...

<Comments page={frontMatter.slug} />
```

### VitePress
```vue
<template>
  <div>
    <!-- æ–‡æ¡£å†…å®¹ -->
    <Comments :page="$page.relativePath" />
  </div>
</template>
```

### Nextra
```tsx
import { Comments } from "@fuma-comment/react";

export default function Layout({ children }) {
  return (
    <>
      {children}
      <Comments page={router.asPath} />
    </>
  );
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é¡µé¢ ID ç­–ç•¥
```tsx
// æ¨èä½¿ç”¨ç¨³å®šçš„é¡µé¢æ ‡è¯†ç¬¦
<Comments page={`docs-${slug}`} />
<Comments page={pathname} />
<Comments page={`${version}-${slug}`} /> // ç‰ˆæœ¬åŒ–æ–‡æ¡£
```

### 2. æƒé™æ§åˆ¶
```tsx
// åœ¨ schema.ts ä¸­è‡ªå®šä¹‰è§’è‰²
export const roles = pgTable("roles", {
  userId: varchar("userId", { length: 256 }).primaryKey(),
  name: varchar("name", { length: 256 }).notNull(),
  canDelete: boolean("canDelete").notNull(),
  canModerate: boolean("canModerate").default(false),
});
```

### 3. è¯„è®ºåŒºä½ç½®
```tsx
// å»ºè®®æ”¾åœ¨æ–‡æ¡£å†…å®¹æœ«å°¾
export default function DocPage() {
  return (
    <article>
      <h1>{title}</h1>
      <div>{content}</div>
      
      {/* è¯„è®ºåŒº */}
      <section className="mt-12 pt-8 border-t">
        <h2 className="text-xl font-semibold mb-4">è®¨è®º</h2>
        <Comments page={pageId} />
      </section>
    </article>
  );
}
```

---

## ğŸš€ éƒ¨ç½²æ³¨æ„äº‹é¡¹

### Vercel éƒ¨ç½²
1. åœ¨ Vercel ç¯å¢ƒå˜é‡ä¸­è®¾ç½®æ‰€æœ‰ `.env.local` çš„å€¼
2. ç¡®ä¿ `BETTER_AUTH_URL` è®¾ç½®ä¸ºç”Ÿäº§åŸŸå
3. æ›´æ–° GitHub OAuth åº”ç”¨çš„å›è°ƒåœ°å€

### å…¶ä»–å¹³å°
1. ç¡®ä¿ç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½®
2. æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²åŒ…å«æ­£ç¡®çš„ SSL é…ç½®
3. æ„å»ºæ—¶åŒ…å«å¿…è¦çš„ä¾èµ–

---

## ğŸ‰ æ€»ç»“

`/apps/example-better-auth` æ˜¯ä½ çš„å®Œæ•´å‚è€ƒæ¨¡æ¿ï¼ä¸»è¦æ­¥éª¤ï¼š

1. âœ… **å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶** (lib/, api/, drizzle.config.ts)
2. âœ… **å®‰è£…ä¾èµ–åŒ…**
3. âœ… **é…ç½®ç¯å¢ƒå˜é‡**
4. âœ… **æ¨é€æ•°æ®åº“æ¶æ„**
5. âœ… **åœ¨é¡µé¢ä¸­ä½¿ç”¨ `<Comments>` ç»„ä»¶**

ç°åœ¨ä½ å°±æœ‰äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è¯„è®ºç³»ç»Ÿï¼ğŸŠ
